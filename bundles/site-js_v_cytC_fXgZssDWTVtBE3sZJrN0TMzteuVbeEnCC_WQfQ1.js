var WLL=function(){var r=function(n){return n==null||n==""?"":$("<div/>").text(n).html()},u=function(n){try{return n==null?"":encodeURIComponent(n)}catch(t){return""}},f=function(n,t){if(t==null)return n;var i=n.indexOf("?")>=0?"&":"?";return n+i+t},n=function(n,t){if(n!=null){var i=n.not("form");t?i.removeAttr("disabled").removeClass("disabled-temporarily"):i.attr("disabled","disabled").addClass("disabled-temporarily")}},e=function(){$(this).addClass("disabled-temporarily")},o=function(){Tabs.LoadActiveTabs();Tabs.LoadActivePanels();t()},t=function(){Controls.Ready();Validation.Ready()},s=function(){i($(this))},i=function(t){n(t,!1)},h=function(){n($(".disabled-temporarily"),!0)};return{HtmlEncode:r,UrlEncodeComponent:u,AddToUrl:f,SetButtonFinished:n,AddWaitCursor:e,DocumentReady:o,ContentReady:t,OnBegin:s,OnComplete:h,OnBeginFunction:i}}();$(document).ready(function(){WLL.DocumentReady()});var FileUpload=function(){var f=function(){var i=$(this).parents(".jq-upload-file"),n=i.find(".jq-upload-file-hidden");n.val("");t(n);Validation.ClearFieldError(n);o(i.find(".progress-bar"));n.click()},t=function(n){var t=e(n.val());n.parents(".jq-upload-file").find(".jq-upload-file-textbox").val(t)},e=function(n){if(n==null||n=="")return"";var t=n.indexOf("\\")>=0?"\\":"/";return n.split(t).pop()};$(document).on("click",".jq-upload-file-button, .jq-upload-file-textbox",f);$(document).on("change",".jq-upload-file-hidden",function(){t($(this))});var o=function(n){i(n);r(n,!0)},n=function(n,t){var i=t,u;i<0&&(i=0);i>100&&(i=100);u=i+"%";n.width(u);n.html(u);r(n,!1)},i=function(t){n(t,0);t.removeClass("progress-bar-danger").addClass("progress-bar-success")},s=function(n){n.removeClass("progress-bar-success").addClass("progress-bar-danger")},r=function(n,t){n.parent().toggleClass("invisible",t)},h=function(n,t,i){n.ajaxForm(u(n,null,t,i))},c=function(n,t,i,r){n.ajaxSubmit(u(n,t,i,r))},u=function(t,r,u,f){var e=t.find(".progress-bar");return{data:r||{},beforeSend:function(){i(e)},uploadProgress:function(t,i,r,u){n(e,u)},success:function(t){n(e,100);u!=null&&u(t)},error:function(){s(e);f!=null&&f()}}};return{AjaxForm:h,AjaxSubmit:c}}(),Toastr=function(){toastr.options.closeButton=!0;toastr.options.newestOnTop=!0;var i=function(t){n(toastr.info,t,"")},r=function(t){n(toastr.success,t,"")},u=function(t){n(toastr.warning,t,"Warning")},t=function(t){n(toastr.error,t,"Error")},n=function(n,t,i){try{var r=f(t);if(r=="")return;n(r,i)}catch(u){}},f=function(n){return n==null||n==""?"":$("<div/>").text(n).html()},e=function(){t("Cannot communicate with server.")};return{Info:i,Success:r,Warning:u,Error:t,CommsError:e}}(),Tabs=function(){var r='a[data-toggle="tab"][data-url]';$(document).on("click",r,function(){i($(this))});var u=function(){$("a.active > "+r).each(function(){i($(this))})},f=function(){$("a.nav-link.active").each(function(){i($(this))})},n="jq-tab-loading",t="jq-tab-loaded",i=function(n){var r=n.attr("data-url"),i;r!==null&&(i=n.attr("data-load-target")||n.attr("data-reload-target")||n.attr("data-target"),n.hasClass(t)&&(i=n.attr("data-reload-target")),i!==null)&&e(n,r,i)},e=function(i,r,u){i.hasClass(n)||(i.addClass(n),$.ajax(r,{dataType:"html",success:function(n){$(u).html(n);i.addClass(t);WLL.ContentReady()},error:function(){Toastr.Error("loading tab contents.");i.removeClass(t)},beforeSend:function(){if(r=="")return $(u).html("Target URL is empty and cannot be loaded."),!1},complete:function(){i.removeClass(n)}}))},o=function(){$(".nav-tabs .active").click();$("a.nav-link.active").click()};return{LoadActiveTabs:u,LoadActivePanels:f,ReloadActive:o}}(),Controls=function(){var i=function(){$(".selectpicker").selectpicker({liveSearch:!0,showSubtext:!0,size:15});$('[data-toggle="tooltip"]').tooltip();$(".form-auto-submit").off("change").on("change",u)},n=function(n){return $("#"+n+"_SelectedValue")},r=function(t,i){var r=n(t),u,f;if(r.length===0)return null;if(i===undefined)return r.val();r.val(i);u=r.attr("data-ddtextbox");u!==null&&(f=r.find("option:selected").text(),r.parent().find("#"+u).val(f))},u=function(){var n=$(this).closest("form");n.find('button[type="submit"]').attr("disabled","disabled");n.submit()},f=function(n){try{if(n.length===0)return;var t=n.offset(),i=Math.max(0,t.top-100),r=Math.max(0,t.left);$("html, body").scrollTop(i).scrollLeft(r)}catch(u){}},e=function(n){var i=$("#"+n),u=i.closest(".signature-pad-container"),f=u.find("canvas").get(0),t=new SignaturePad(f),r;t.onEnd=function(){t.isEmpty()?i.val(""):i.val(t.toDataURL())};r=i.val();r!==null&&r!==""&&t.fromDataURL(r);u.find(".jq-signature-pad-clear").off("click").on("click",function(){t.clear();t.onEnd()});$(document).find("*").css("user-select","none")},o=function(){try{var n=parseFloat($(this).val());isNaN(n)||$(this).val(n.toFixed(2))}catch(t){}},s=function(){var r=$("input#happy").siblings("img")[0],n,t,i;$(r).attr("src","/img/svg/happy-face-white.svg");$("input#happy").attr("checked",!1);n=$("input#indifferent").siblings("img")[0];$(n).attr("src","/img/svg/indifferent-face-white.svg");$("input#indifferent").attr("checked",!1);t=$("input#sad").siblings("img")[0];$(t).attr("src","/img/svg/sad-face-white.svg");$("input#sad").attr("checked",!1);$($(this).siblings("input")[0]).attr("checked",!0);i=$($(this).siblings("input")[0]).attr("id");switch(i){case"happy":$(this).attr("src","/img/svg/happy-face.svg");break;case"indifferent":$(this).attr("src","/img/svg/indifferent-face.svg");break;case"sad":$(this).attr("src","/img/svg/sad-face.svg")}},h=function(){$(".date-picker").length&&$(".date-picker").bootstrapDP()},c=function(){$(".date-time-picker").length&&$(".date-time-picker").datetimepicker({locale:"en-gb"})},l=function(n){var t=$(n.data.control).val().toLowerCase();$(n.data.list).filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(t)>-1)})},t;$(document).on("blur change","input.money-editor-template",o);return t=function(n,t,i,r){var o=$(n),e=$(i),u="",t=t,s=o.val(),f;if(r!=null&&r.length>0){for(f=0;f<r.length;f++)u=Modal.SerializedAdd(u,r[f].Attr,r[f].Query);u=Modal.SerializedAdd(u,"inputValue",s);t=t+"?"+u}$.get(t,{inputValue:s},function(n){n?(e?e.prop("disabled",!0):$("#Save").prop("disabled",!0),o.css("background-color","#e97878"),$(".jq-modal-submit").prop("disabled",!0),toastr.error(n)):(e?e.prop("disabled",!1):$("#Save").prop("disabled",!1),$(".jq-modal-submit").prop("disabled",!1),o.css("background-color","#76D7C4"))})},{DropdownVal:r,$Dropdown:n,ScrollIntoView:f,Signature:e,Ready:i,ImageRadioSwitch:s,InitialiseDatePicker:h,InitialiseDateTimePicker:c,FilterList:l,CheckInputValueExisits:t}}(),Modal=function(){var s=function(n,t,i,r,u){h(n,!1);var f=function(){h(n,!0)};ut(i);$.ajax(t,{type:"GET",datatype:"html",success:function(n){if(c(n)){b(n);f();return}e(i,n);nt(i,function(){at($(this),i,r,u)},function(){f()})},error:function(){Toastr.CommsError();f()}})},h=function(n,t){WLL.SetButtonFinished(n,t);$(v()).toggle(!t)},nt=function(r,u,f){i(r,null);y(r,u);t(r,!0);$(n(r)).modal({show:!0,backdrop:"static"});$(n(r)).off("hidden.bs.modal").on("hidden.bs.modal",function(){tt(r);f!=null&&f()})},r=function(t){$(n(t)).modal("hide")},c=function(n){return k(n,"ModalSuccess")==!0},tt=function(n){y(n,null);i(n,null);e(n,null)},n=function(n){return"#jq-modal-id-"+n},u=function(t){return n(t)+" .jq-modal-submit"},it=function(t){return n(t)+" .jq-modal-link"},f=function(t){return n(t)+" .jq-modal-confirm-fields"},l=function(t){return n(t)+" .jq-modal-confirm-date"},a=function(t){return n(t)+" .jq-modal-content"},rt=function(t){return n(t)+" .jq-modal-error"},v=function(){return"#RCM-modal-backdrop"},ut=function(n){$(it(n)).removeAttr("data-href").attr("disabled","disabled").off("click").on("click",et)},ft=function(n){var t=$(".jq-modal-link");ot(t,"data-href",n);n!=null&&n!=""&&t.removeAttr("disabled")},et=function(){var n=$(this).attr("data-href");n&&(WLL.SetButtonFinished($(this),!1),window.location.href=n)},ot=function(n,t,i){n.each(function(){i==null||i==""?$(this).removeAttr(t):$(this).attr(t,i)})},y=function(n,t){var i=$(u(n));if(i.off("click"),t!=null)i.on("click",t)},t=function(n,t){var i=$(u(n));WLL.SetButtonFinished(i,t)},st=function(n,t){var i=$(u(n)).filter('[name="'+t+'"]');i.click()},p=function(n,t){$(f(n)).toggle(t==!0);t&&($(l(n)).each(w),$(l(n)).change(w))},w=function(){var n=$(this).parents(".jq-modal-content").first().find(".jq-modal-confirm-early"),t=ht($(this),n.attr("data-early-warning"));n.toggle(t)},ht=function(n,t){var i,r;return t==null?!1:(i=n.val(),i==null||i=="")?!1:(r=moment().startOf("day").subtract(t,"days"),moment(i).startOf("day").isBefore(r))},ct=function(n,t,i,r){var f=$(a(n)+" form"),u={};t!=null&&(u.SubmitName=t);FileUpload.AjaxSubmit(f,u,i,r)},lt=function(n,t,i){var r=n;return r==null||r==""?r="":r+="&",r+=t,r+="=",r+WLL.UrlEncodeComponent(i)},i=function(n,t){var i=$(rt(n));t==null?i.hide().empty():i.text(t).show()},at=function(n,r,u,f){if(!vt(n,r)){var o=n.attr("name");t(r,!1);ct(r,o,function(n){i(r,null);c(n)?(b(n),u(o),f==!0&&location.reload()):(e(r,n),t(r,!0))},function(){i(r,"Error submitting form.");t(r,!0)})}},vt=function(n,t){return n.hasClass("jq-modal-confirm")?$(f(t)).is(":visible")?!1:$(f(t)).length==0?!1:(p(t,!0),!0):!1},e=function(n,t){$(a(n)).html(t);WLL.ContentReady();var i=k(t,"ShowConfirm")==!0;p(n,i)},b=function(n){$(n).find("script").addBack("script").each(function(){try{var js=$(this).html();js!=null&&eval(js)}catch(e){}})},k=function(n,t){var i=$(n).find('input[type="hidden"][name="'+t+'"]').val();return i==null?!1:i.toLowerCase()=="true"},o=function(n,t,i,u,f){s(n,t,i,function(n){r(i);u!=null&&u(n)},f)},yt=function(n,t,i,r,u){var f=g(n,r),e;f!=null&&(e=t+"?"+f,o(n,e,i,Tabs.ReloadActive,u))},pt=function(n,t,i,r){o(n,t,i,Tabs.ReloadActive,r)},wt=function(n,u,f){s(f,n,u,function(){d(f,function(){r(u)},function(){i(u,"Error updating page.");t(u,!1)})})},d=function(n,t,i){var u=n.attr("href"),f=n.attr("data-ajax-update"),r=n.attr("data-ajax-method");r=r==null?"POST":r.toUpperCase();$.ajax(u,{type:r,datatype:"html",success:function(n){$(f).html(n);t!=null&&t()},error:i})},g=function(n,t){for(var r,u="",i=0;i<t.length;i++)r=n.closest("["+t[i].Attr+"]").attr(t[i].Attr),r==null&&(r=t[i].Attr),r!=null&&(u=lt(u,t[i].Query,r));return u},bt=function(n){n.preventDefault();n.stopPropagation()};$(document).on("click",v(),bt);return{Open:o,OpenFromTab:yt,OpenFromSecondaryTab:pt,BeforeActionLink:wt,ActionLink:d,QueryParameters:g,SetupLinkButton:ft,PressSubmitButton:st,CloseWindow:r}}(),Validation=function(){var i=function(){n()},n=function(){$(".input-validation-error").closest(".form-group, .form-inline").addClass("has-error");$(".field-validation-error").addClass("text-danger");$(".validation-summary-errors").addClass("alert alert-danger").filter(":not(:has(li:visible))").remove()},r=function(i,r){t(i);i.addClass("input-validation-error");$("<span />").addClass("field-validation-error").text(r).insertAfter(i);n()},t=function(n){n.removeClass("input-validation-error");n.parents(".has-error").removeClass("has-error").find(".field-validation-error, .field-validation-valid").remove()};return{FixupMvc:n,FieldError:r,ClearFieldError:t,Ready:i}}()